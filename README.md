short-link-service
=============
Краткое описание
----------------
REST-сервис по предоставлению ссылок пользователям.
Используемые технологии:
- Java 11
- Spring;
- Lombok;
- JUnit и Mockito;
- встраиваемая СУБД H2.

Краткое описание классов 
------------------------
В корневом пакете проекта ```org.sls.shortlinkservice``` находится класс ```Application```, содержащий в себе точку входа в приложение.

В пакете ```controller``` содержится класс:
- ```UrlController``` - контроллер, осуществляющий генерацию новых коротких ссылок, получение оригинальных полнных ссылок на основе коротких и переадресацию.

В пакете ```service``` содержится класс:
- ```UrlService``` - сервис, реализующий основную логику программы.

В пакете ```repository``` содержится интерфейс хранилища данных ```UrlRepository```, логика которого имплементируется автоматически с помощью библиотеки Spring Data JPA.

В пакете ```model``` содержится класс:
- ```Url``` - класс-модель данных, хранящихся в ```UrlRepository```.

В пакете ```exceptions``` содержатся классы исключений:
- ```NotFoundException``` - исключение, генерируемое классом ```UrlService```, если ссылка, переданная как параметр, не была найдена в хранилище;
- ```TokenTimeOutException``` - исключение, генерируемое классом ```UrlService```, если время жизни сгенерированной короткой ссылки больше 10 минут.

В пакете ```dto``` содержатся классы:
- ```CreateRequest``` - обработка клиентских запросов;
- ```CreateResponse``` - обработка ответов клиенту.


Описание внешнего программного интерфейса
-----------------------------------------
### Генерация коротких ссылок
Для создания новой короткой ссылки необходимо послать POST-запрос на адрес ```/create```. В теле запроса дожен находиться объект в формате JSON со строковым параметром ```originalUrl```.

В ответе возвращается объект с единственным полем ```link```, в котором указывается сгенерированная короткая ссылка.

Пример запроса:
```http
POST /generate HTTP/1.1
Host: localhost:8080
Content-Type: application/json

{
	"originalUrl": "yandex.ru"
}
```
Пример ответа:
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
    "link": "/VYepjW"
}
```
В случаях если поле ```originalUrl``` будет иметь неверный формат, клиенту возвращается код ```400 Bad Request``` и короткая ссылка не будет создана.


### Получение полной ссылки на основе короткой
Для получения оригинальной полной ссылки на основе короткой необходимо осуществить GET-запрос на адрес ```/getOriginalUrl/```

Пример запроса:
```http
GET /getOriginalUrl/VYepjW HTTP/1.1
```

Пример ответа:
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
    "token": "/VYepjW"
}
```

### Переход по короткой ссылке
Для перехода по короткой ссылке необходимо осуществить GET-запрос по ссылке,
возвращенной на шаге генерации.
```http
GET /VYepjW HTTP/1.1
```

При попытке перехода по короткой ссылке которая не существует в базе данных, клиенту возвращается код ```404 Not Found```.
При попытке перехода по короткой ссылке время жизни которой превышает 10 минут, клиенту возвращается код ```403 Forbidden "The short URL's lifetime has ended"```.
